---
 - hosts: 192.168.2.2

   gather_facts: no

   strategy: free
   become_user: root
   become: yes
   become_method: sudo


   tasks:
   - name: get a list of downloaded patch files.
     find:
       file_type: file
       paths: '.'
       patterns: '*.py'
     register: find_results

   - name: print find_results
     #debug: var=item
     debug: var=item.path
     with_items: '{{find_results.files}}'
     #with_items: '{{find_results}}'

#   - name: install those patches
#     yum:
#       name: '{{find_results}}'
#       state: present
#     with_items: '{{find_results.files}}'

# To update repositories cache using Ansible:
   - name: Update apt-get repo and cache
      apt: update_cache=yes force_apt_get=yes cache_valid_time=3600

   - name: Upgrade all apt packages
     apt: upgrade=dist force_apt_get=yes
     
   - name: Reboot the Debian or Ubuntu server
      reboot: 
        msg: "Reboot initiated by Ansible due to kernel updates"
        connect_timeout: 5
        reboot_timeout: 300
        pre_reboot_delay: 0
        post_reboot_delay: 30
        test_command: uptime
      when: reboot_required_file.stat.exists